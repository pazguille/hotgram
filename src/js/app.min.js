// http://jscompress.com/
(function(a){"use strict";var b=function(){var a=Backbone.Model.extend({}),b=Backbone.Collection.extend({model:a,sync:function(a,b,c){c.dataType="jsonp";c.data={client_id:"8592b07f6eaf4efb9e3b6c7a054b6aa0"};return Backbone.sync(a,b,c)},parse:function(a){return a.data},popularUrl:function(){return this.url="https://api.instagram.com/v1/media/popular"},searchUrl:function(a){return this.url="https://api.instagram.com/v1/tags/"+a+"/media/recent"},url:"https://api.instagram.com/v1/media/popular"}),c=Backbone.View.extend({tagName:"li",template:_.template($("#tpl-photo").html()),render:function(){var a=this.model,b=a.get("caption"),c="";if(b!==null){c=a.get("caption").text}a.set("description",c);a=a.toJSON();$(this.el).html(this.template(a));return this}}),d=Backbone.View.extend({el:"#hottest",initialize:function(){var a=this,c=$("#query");this.collection=new b;this.$search.on("submit",function(){a.query=c.val();a.searching();return false});this.$el.prepend(this.$list);this.$el.removeClass("ch-hide");this.reset();this.fetch()},events:{scroll:"more","click .pic":"pic"},$list:$('<ul class="ch-slats ch-hide">'),$loading:$(".ch-loading"),$search:$(".ch-header-form"),query:"",render:function(){var a=this;_.each(this.collection.models,function(b){var d=new c({model:b});a.$list.append(d.render().el)},this);this.$list.removeClass("ch-hide");return this},fetch:function(){var a=this;this.$loading.removeClass("ch-hide");this.collection.fetch({success:function(){a.$loading.addClass("ch-hide");a.render()}})},more:function(){var a=this.$list.height()-this.$el.height(),b=this.el.scrollTop;if(a===b){this.fetch()}return},pic:function(a){chrome.tabs.create({url:a.currentTarget.href});return false},searching:function(){if(this.query!==""){this.collection.searchUrl(this.query)}else{this.collection.popularUrl()}this.reset();this.fetch()},reset:function(){this.collection.reset();this.$list.html("")}}),e={hottest:d};return e}();a.app=new b.hottest})(this)